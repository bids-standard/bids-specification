# Rules for events data that are not defined in tables.
---
# 25
EventsMissing:
  issue:
    code: EVENTS_TSV_MISSING
    message: |
      Task scans should have a corresponding 'events.tsv' file.
      If this is a resting state scan you can ignore this warning or rename the task to include the word "rest".
    level: warning # could be an error with the proper selectors, I think
  selectors:
    - dataset.dataset_description.DatasetType == "raw"
    - '"task" in entities'
    - '!match(entities.task, "rest")'
    - suffix != "events"
  checks:
    - '"events" in associations'

StimulusFileMissing:
  issue:
    code: STIMULUS_FILE_MISSING
    message: |
      A stimulus file was declared but not found in the dataset.
    level: error
  selectors:
    - suffix == "events"
    - columns.stim_file != null
  checks:
    - exists(columns.stim_file, "stimuli") == length(columns.stim_file) - count(columns.stim_file, "n/a")
