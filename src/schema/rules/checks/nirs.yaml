---
NASamplingFreq:
  selectors:
    - datatype == "nirs"
    - suffix == "channels"
    - extension == ".tsv"
    - associations.nirs.json.SamplingFrequency == 'n/a'
  checks:
    - columns.sampling_frequency != null

NIRSChannelCount:
  selectors:
    - datatype == "nirs"
    - suffix == "nirs"
  checks:
    - |
      sidecar(NIRSChannelCount)
      == count(associations.channels.type, "NIRSCWAMPLITUDE")
      +  count(associations.channels.type, "NIRSCWFLUORESCENSEAMPLITUDE")
      +  count(associations.channels.type, "NIRSCWOPTICALDENSITY")
      +  count(associations.channels.type, "NIRSCWHBO")
      +  count(associations.channels.type, "NIRSCWHBR")
      +  count(associations.channels.type, "NIRSCWMUA")
ACCELChannelCountReq:
  selectors:
    - datatype == "nirs"
    - suffix == "channels"
    - extension == ".tsv"
    - intersect(columns.type, ["ACC"])
  checks:
    - associations.nirs.ACCELChannelCount != null

GYROChannelCountReq:
  selectors:
    - datatype == "nirs"
    - suffix == "channels"
    - extension == ".tsv"
    - intersect(columns.type, ["GYRO"])
  checks:
    - associations.nirs.GYROChannelCount != null

MAGNChannelCountReq:
  selectors:
    - datatype == "nirs"
    - suffix == "channels"
    - extension == ".tsv"
    - intersect(columns.type, ["MAGN"])
  checks:
    - associations.nirs.MAGNChannelCount != null

OrientationComponent:
  selectors:
    - datatype == "nirs"
    - suffix == "channels"
    - extension == ".tsv"
    - '["ACCEL", "GYRO", "MAGN"].includes(columns.type[0])'
  checks:
    - columns.orientation_component != null

RequiredChannels:
  selectors:
    - datatype == "nirs"
    - suffix == "optodes"
    - extension == ".tsv"
  checks:
    - associations.channels != null

RequiredTemplateX:
  selectors:
    - datatype == "nirs"
    - suffix == "optodes"
    - extension == ".tsv"
    - columns.x[0] == "n/a"
  checks:
    - columns.template_x != null

RequiredTemplateY:
  selectors:
    - datatype == "nirs"
    - suffix == "optodes"
    - extension == ".tsv"
    - columns.y[0] == "n/a"
  checks:
    - columns.template_y != null

RequiredTemplateZ:
  selectors:
    - datatype == "nirs"
    - suffix == "optodes"
    - extension == ".tsv"
    - columns.z[0] == "n/a"
  checks:
    - columns.template_z != null

RequiredCoordsystem:
  selectors:
    - datatype == "nirs"
    - suffix == "optodes"
    - extension == ".tsv"
  checks:
    - associations.coordsystem != null
