#
# Groups of related metadata fields
#
# Assumptions: never need disjunction of selectors
# Assumptions: top-to-bottom overrides is sufficient logic

---
# Groups are defined as they appear in the proposal

microephysInstitutionInformation:
  selectors:
    - datatype == ["ecephys", "icephys"]
    - suffix == ["ecephys", "icephys"]
  fields:
    InstitutionName: recommended
    InstitutionAddress: recommended
    InstitutionalDepartmentName: recommended

microephysSetup:
  selectors:
    - datatype == ["ecephys", "icephys"]
    - suffix == ["ecephys", "icephys"]
  fields:
    PowerLineFrequency: required
    Manufacturer:
      level: recommended
      description_addendum: For example, `"TDT"`, `"Blackrock"`.
    ManufacturersModelName: recommended
    ManufacturersModelVersion: recommended
    RecordingSetupName: recommended
    SamplingFrequency:
      level: required
      description_addendum: |
         Internal (maximum) sampling frequency (in Hz)
         of the recording (for example, "24000").
    DeviceSerialNumber:
      level: recommended
      description_addendum: |
         The serial number of the components of the setup,
         recommended to add serial numbers and versions of
         ALL components constituting the setup.
    SoftwareName:
      level: recommended
      description_addendum: |
         The name of the software suite used to
         record the data.
    SoftwareVersions: recommended

microephysProcessing:
  selectors:
    - datatype == ["ecephys", "icephys"]
    - suffix == ["ecephys", "icephys"]
  fields:
    SoftwareFilters: required
    HardwareFilters: recommended

microephysPharmaceuticals:
  selectors:
    - datatype == ["ecephys", "icephys"]
    - suffix == ["ecephys", "icephys"]
  fields:
    PharmaceuticalName: recommended
    PharmaceuticalDoseAmount: recommended
    PharmaceuticalDoseUnits: recommended
    PharmaceuticalDoseRegimen: recommended
    PharmaceuticalDoseTime: recommended

# TODO: Check how to conditionally change level to required for photo if
# MicroephysCoordinateSystem is Pixels
microephysCoordsystemGeneral:
  selectors:
    - datatype == ["ecephys", "icephys"]
    - suffix == "coordsystem"
  fields:
    MicroephysCoordinateSystem: required
    MicroephysCoordinateSystemDescription: recommended
    MicroephysCoordinateUnits: required
    MicroephysCoordinateSystemPhoto: optional

microephysSupplementary:
  selectors:
    - datatype == ["ecephys", "icephys"]
    - suffix == ["ecephys", "icephys"]
  fields:
    SupplementarySignals: optional

microephysSample:
  selectors:
    - datatype == ["ecephys", "icephys"]
    - suffix == ["ecephys", "icephys"]
  fields:
    BodyPart: recommended
    BodyPartDetails: recommended
    BodyPartDetailsOntology: optional
    SampleEnvironment: recommended
    SampleEmbedding: optional
    SliceThickness: optional
    SampleExtractionProtocol: optional

microephysTaskInformation:
  selectors:
    - datatype == ["ecephys", "icephys"]
    - suffix == ["ecephys", "icephys"]
  fields:
    TaskName:
      level: recommended
      description_addendum: |
        A recommended convention is to name resting state task using labels
        beginning with `rest`.
    TaskDescription: recommended
    Instructions:
      level: recommended
      description_addendum: |
        This is especially important in context of resting state recordings and
        distinguishing between eyes open and eyes closed paradigms.
    CogAtlasID: recommended
    CogPOID: recommended
